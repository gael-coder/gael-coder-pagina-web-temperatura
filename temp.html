<html>
<head>
	<meta charset="UTF-8">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="raphael-2.1.4.min.js"></script>
	<script src="justgage.js"></script>

	<script>
		var accessToken = "79f854ee305ccaf94fe8473f2ff708ad38befaf5";
		var deviceID = "e00fce68ce6885f40a76bd65";
		var urlCelsius = "https://api.particle.io/v1/devices/" + deviceID + "/gradosC";
		var urlPresion = "https://api.particle.io/v1/devices/" + deviceID + "/presion";
		var urlAltitud = "https://api.particle.io/v1/devices/" + deviceID + "/altitud";
		var urlHumedad = "https://api.particle.io/v1/devices/" + deviceID + "/humedad";

		function callbackCelsius(data, status) {
			if (status == "success") {
				var tempC = parseFloat(data.result).toFixed(2);
				gCelsius.refresh(tempC);
				if (tempC < 20) {
					document.body.style.backgroundColor = "lightblue";
				} else if (tempC >= 20 && tempC <= 40) {
					document.body.style.backgroundColor = "orange";
				} else {
					document.body.style.backgroundColor = "red";
				}
			} else {
				alert("There was a problem with the Celsius API.");
			}
		}

		

		function callbackHumedad(data, status) {
			if (status == "success") {
				var humedad = parseFloat(data.result).toFixed(2);
				gHumedad.refresh(humedad);
			} else {
				alert("There was a problem with the Humedad API.");
			}
		}

		function callbackPresion(data, status) {
			if (status == "success") {
				var presion = parseFloat(data.result).toFixed(2);
				gPresion.refresh(presion);
			} else {
				alert("There was a problem with the Presion API.");
			}
		}

		function callbackAltitud(data, status) {
			if (status == "success") {
				var altitud = parseFloat(data.result).toFixed(2);
				gAltitud.refresh(altitud);
			} else {
				alert("There was a problem with the Altitud API.");
			}
		}

		function getReading() {
			$.get(urlCelsius, { access_token: accessToken }, callbackCelsius);
			$.get(urlHumedad, { access_token: accessToken }, callbackHumedad);
			$.get(urlPresion, { access_token: accessToken }, callbackPresion);
			$.get(urlAltitud, { access_token: accessToken }, callbackAltitud);
			setTimeout(getReading, 1000);
		}
	</script>
</head>

<body>
	<div id="gaugeCelsius" style="width:200px; height:160px;"></div>
	<div id="gaugeHumedad" style="width:200px; height:160px;"></div>
	<div id="gaugePresion" style="width:200px; height:160px;"></div>
	<div id="gaugeAltitud" style="width:200px; height:160px;"></div>

	<script>
		var gCelsius = new JustGage({
			id: "gaugeCelsius",
			value: 0,
			min: 0,
			max: 100,
			title: "Temperatura (°C)"
		});


		var gHumedad = new JustGage({
			id: "gaugeHumedad",
			value: 0,
			min: 0,
			max: 100,
			title: "Humedad (%)"
		});

		var gPresion = new JustGage({
			id: "gaugePresion",
			value: 0,
			min: 700,
			max: 1100,
			title: "Presión (hPa)"
		});

		var gAltitud = new JustGage({
			id: "gaugeAltitud",
			value: 0,
			min: 0,
			max: 5000,
			title: "Altitud (m)"
		});

		getReading();
	</script>
</body>
</html>

